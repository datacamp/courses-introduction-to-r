---
title_meta: Capitolo 5
title: Data frame
description: >-
  La maggior parte dei set di dati con cui lavorerai sarà organizzata in data
  frame. Alla fine di questo capitolo, imparerai a crearne uno, estrarne le
  informazioni più rilevanti e modificarne l’ordine in base a determinate
  variabili.
---

## Cos'è un data frame?

```yaml
type: NormalExercise
key: 7f95849020a2563168920409022ce7bed20835b5
xp: 100
skills:
  - 1
```

Forse ricorderai che tutti gli elementi inseriti in una matrice devono essere dello stesso tipo. Nel capitolo corrispondente, il tuo set di dati su Star Wars conteneva solo elementi numerici. 

Quando si conduce un'indagine di mercato, tuttavia, capita spesso di imbattersi in domande come:

- "Sei sposato/a?" oppure in quesiti a risposta "sì/no". (`logical`)
- “Quanti anni hai?" (`numeric`)
- "Qual è la tua opinione su questo prodotto?" o altre domande "aperte" (`character`)
- ...

L’output, ovvero le risposte degli intervistati alle domande formulate in precedenza, è costituito da dati di tipo diverso. Spesso ti troverai a lavorare con dataset che includono diversi tipi di dati, anziché uno solo. 

Un data frame rappresenta le variabili come colonne e le osservazioni come righe. Si tratta di un concetto familiare per chi proviene da pacchetti software statistici diversi come SAS o SPSS.

`@instructions`
poi invia la risposta. I dati del data frame di esempio integrato `mtcars` verranno stampati sulla console.

`@hint`
Invia la risposta e osserva la magia!

`@pre_exercise_code`
```{r}
# no pec
```

`@sample_code`
```{r}
# Print out built-in R data frame
mtcars 
```

`@solution`
```{r}
# Print out built-in R data frame
mtcars 
```

`@sct`
```{r}
ex() %>% check_output_expr("mtcars", missing_msg = "Non cambiare nulla nel codice, assicurati di stampare `mtcars`.")

success_msg("Ottimo! Continua con l'esercizio successivo.")
```

---

## Dai un'occhiata veloce al tuo set di dati

```yaml
type: NormalExercise
key: 3d0e64ecf5f69521ee538ecc713caa02b8b0ec46
xp: 100
skills:
  - 1
```

Altro che garage… quante auto! 

Nell'analisi dei dati non è raro lavorare con set di dati di grandi dimensioni. Quando lavori con set di dati e data frame (estremamente) grandi, in qualità di Data Analyst la prima cosa da fare è sviluppare una chiara comprensione della loro struttura e dei loro elementi principali. Pertanto, spesso è utile mostrare solo una piccola parte dell'intero set di dati. 

Come farlo in R? La funzione `head()` ti permette di visualizzare le prime osservazioni di un data frame. Allo stesso modo, la funzione `tail()` stampa le ultime osservazioni del tuo set di dati.

Sia `head()` che `tail()` stampano una riga superiore chiamata intestazione (<i>header</i>), che contiene i nomi delle diverse variabili del set di dati.

`@instructions`
Esegui la funzione `head()` sul set di dati `mtcars` per vedere l’intestazione e le prime osservazioni.

`@hint`
`head(mtcars)` mostrerà le prime osservazioni del data frame `mtcars`.

`@pre_exercise_code`
```{r}
# no pec
```

`@sample_code`
```{r}
# Call head() on mtcars

```

`@solution`
```{r}
# Call head() on mtcars
head(mtcars)
```

`@sct`
```{r}
ex() %>% check_function("head") %>% check_arg('x') %>% check_equal(incorrect_msg = "Hai passato correttamente `mtcars` alla funzione `head()`?")

ex() %>% check_output_expr("head(mtcars)", missing_msg = "Stampa semplicemente il risultato della chiamata `head()`, non c'è bisogno di assegnarlo a una nuova variabile.")

success_msg("Meraviglioso! Allora, cosa abbiamo in questo dataset? Per esempio, `hp` rappresenta la potenza dell'auto; la Datsun ha la potenza più bassa delle 6 auto visualizzate. Per una panoramica completa del significato delle variabili, digita `?mtcars` nella console e leggi la pagina di aiuto. Continua al prossimo esercizio!");
```

---

## Dai un'occhiata alla struttura

```yaml
type: NormalExercise
key: f4d5b1a2c4aef31645fc7e3505e699fb6e48f3e6
xp: 100
skills:
  - 1
```

Un altro metodo che viene spesso utilizzato per avere una panoramica veloce dei dati è la funzione `str()`. La funzione `str()` mostra la struttura del tuo set di dati. In un data frame ti dice:

- Il numero totale di osservazioni (ad es. 32 tipi di auto)
- Il numero totale di variabili (ad es. 11 caratteristiche delle auto)
- Un elenco completo dei nomi delle variabili (ad es. `mpg`, `cyl`... )
- Il tipo di dati di ogni variabile (ad es. `num`)
- Le prime osservazioni

Applicare la funzione `str()` è spesso la prima cosa che fai quando ricevi un nuovo set di dati o un data frame. È un ottimo modo per ottenere maggiori informazioni sul tuo set di dati prima di immergerti nell'analisi vera e propria.

`@instructions`
Analizza la struttura di `mtcars`. Assicurati che i numeri, le variabili e i tipi di dati corrispondano a quelli visualizzati sopra.

`@hint`
Usa la funzione `str()` su `mtcars`.

`@pre_exercise_code`
```{r}
# no pec
```

`@sample_code`
```{r}
# Investigate the structure of mtcars

```

`@solution`
```{r}
# Investigate the structure of mtcars
str(mtcars)
```

`@sct`
```{r}
ex() %>% check_output_expr("str(mtcars)", missing_msg = "Hai chiamato correttamente `str()` su `mtcars`?")

success_msg("Ottimo lavoro! Puoi trovare molte informazioni visualizzando lo `str()` di un dataset. Continua con l'esercizio successivo.")
```

---

## Creare un data frame

```yaml
type: NormalExercise
key: df0b89706d90526b3c0bbe15e400b74cbd900704
xp: 100
skills:
  - 1
```

Dal momento che usare set di set incorporati è molto meno divertente che creane di propri, il resto di questo capitolo sarà basato su un set di dati sviluppato da te. Indossa il tuo zaino-jet perché è arrivato il momento di esplorare lo spazio! 

Come primo obiettivo, vuoi costruire una struttura di dati che descriva le principali caratteristiche di otto pianeti del nostro sistema solare. Secondo il tuo buon amico Buzz, le caratteristiche principali di un pianeta sono:

- Il tipo di pianeta (terrestre o gigante gassoso).
- Il diametro del pianeta rispetto al diametro della Terra.
- La rotazione del pianeta intorno al sole rispetto a quella della Terra.
- Se il pianeta presenta o meno degli anelli (TRUE o FALSE).

Dopo aver fatto una ricerca accurata su [Wikipedia](https://en.wikipedia.org/wiki/Planet), ti senti abbastanza sicuro da poter creare i vettori necessari: `name`, `type`, `diameter`, `rotation` e `rings`; questi vettori sono già stati codificati nell'editor. Il primo elemento di ciascuno di questi vettori corrisponde alla prima osservazione.

Costruisci un data frame con la funzione `data.frame()`. Come argomenti, usa i vettori di prima: diventeranno le diverse colonne del tuo data frame. Dato che ogni colonna ha la stessa lunghezza, anche i vettori che usi devono avere la stessa lunghezza. Ma non dimenticare che è possibile (e probabile) che contengano diversi tipi di dati.

`@instructions`
Usa la funzione `data.frame()` per costruire un data frame. Passa i vettori `name`, `type`, `diameter`, `rotation` e `rings` come argomenti a `data.frame()`, in quest’ordine. Nomina il data frame risultante `planets_df`.

`@hint`
Il tuo comando `data.frame()` inizia così:
```
data.frame(planets, type, diameter)
```
Riesci a terminarlo?

`@pre_exercise_code`
```{r}
# no pec
```

`@sample_code`
```{r}
# Definition of vectors
name <- c("Mercury", "Venus", "Earth", 
          "Mars", "Jupiter", "Saturn", 
          "Uranus", "Neptune")
type <- c("Terrestrial planet", 
          "Terrestrial planet", 
          "Terrestrial planet", 
          "Terrestrial planet", "Gas giant", 
          "Gas giant", "Gas giant", "Gas giant")
diameter <- c(0.382, 0.949, 1, 0.532, 
              11.209, 9.449, 4.007, 3.883)
rotation <- c(58.64, -243.02, 1, 1.03, 
              0.41, 0.43, -0.72, 0.67)
rings <- c(FALSE, FALSE, FALSE, FALSE, TRUE, TRUE, TRUE, TRUE)

# Create a data frame from the vectors
planets_df <-

```

`@solution`
```{r}
# Definition of vectors
name <- c("Mercury", "Venus", "Earth", 
          "Mars", "Jupiter", "Saturn", 
          "Uranus", "Neptune")
type <- c("Terrestrial planet", 
          "Terrestrial planet", 
          "Terrestrial planet", 
          "Terrestrial planet", "Gas giant", 
          "Gas giant", "Gas giant", "Gas giant")
diameter <- c(0.382, 0.949, 1, 0.532, 
              11.209, 9.449, 4.007, 3.883)
rotation <- c(58.64, -243.02, 1, 1.03,
              0.41, 0.43, -0.72, 0.67)
rings <- c(FALSE, FALSE, FALSE, FALSE, TRUE, TRUE, TRUE, TRUE)

# Create a data frame from the vectors
planets_df <- data.frame(name, type, diameter, rotation, rings)
```

`@sct`
```{r}
msg = "Non cambiare nulla nella definizione dei vettori. Aggiungi solo una chiamata a `data.frame()` per creare `planets_df`."
ex() %>% check_object("name", undefined_msg = msg) %>% check_equal(incorrect_msg = msg)

ex() %>% check_object("type", undefined_msg = msg) %>% check_equal(incorrect_msg = msg)

ex() %>% check_object("diameter", undefined_msg = msg) %>% check_equal(incorrect_msg = msg)

ex() %>% check_object("rotation", undefined_msg = msg) %>% check_equal(incorrect_msg = msg)

ex() %>% check_object("rings", undefined_msg = msg) %>% check_equal(incorrect_msg = msg)

ex() %>% check_object("planets_df") %>% check_equal(incorrect_msg = "Hai chiamato correttamente `data.frame()` per creare `planets_df`? All'interno di `data.frame()`, assicurati di passare tutti i vettori nell'ordine corretto: `name`, `type`, `diameter`, `rotation` e infine `rings`.")

success_msg("Ottimo lavoro! Il passo logico successivo, come sai ormai, è ispezionare il data frame che hai appena creato. Vai al prossimo esercizio.")
```

---

## Creare un data frame (2)

```yaml
type: NormalExercise
key: c13ea421dd078030a225f49e53a8927ce8fefbe0
xp: 100
skills:
  - 1
```

Il data frame `planets_df` deve avere 8 osservazioni e 5 variabili. È disponibile nello spazio di lavoro in modo che tu possa utilizzarlo direttamente.

`@instructions`
Usa `str()` per analizzare la struttura della nuova variabile `planets_df`.

`@hint`
`planets_df` è già disponibile nel tuo spazio di lavoro, quindi `str(planets_df)` è tutto ciò che serve.

`@pre_exercise_code`
```{r}
# Definition of vectors
name <- c("Mercury", "Venus", "Earth", 
          "Mars", "Jupiter", "Saturn", 
          "Uranus", "Neptune")
type <- c("Terrestrial planet", 
          "Terrestrial planet", 
          "Terrestrial planet", 
          "Terrestrial planet", "Gas giant", 
          "Gas giant", "Gas giant", "Gas giant")
diameter <- c(0.382, 0.949, 1, 0.532, 
              11.209, 9.449, 4.007, 3.883)
rotation <- c(58.64, -243.02, 1, 1.03,
              0.41, 0.43, -0.72, 0.67)
rings <- c(FALSE, FALSE, FALSE, FALSE, TRUE, TRUE, TRUE, TRUE)

# Create a data frame from the vectors
planets_df <- data.frame(name, type, diameter, rotation, rings)
```

`@sample_code`
```{r}
# Check the structure of planets_df
```

`@solution`
```{r}
# Check the structure of planets_df
str(planets_df)
```

`@sct`
```{r}
msg = "Non rimuovere o sovrascrivere il data frame `planets_df` che è già disponibile nell'ambiente di lavoro!"
ex() %>% check_object("planets_df", undefined_msg = msg) %>% check_equal(incorrect_msg = msg)

ex() %>% check_output_expr("str(planets_df)", missing_msg = "Hai visualizzato correttamente la struttura di `planets_df`? Usa `str()` per farlo!")

success_msg("Ottimo! Ora che hai una chiara comprensione del dataset `planets_df`, è il momento di vedere come puoi selezionare elementi da esso. Scopri tutto nei prossimi esercizi!")
```

---

## Selezionare gli elementi di un data frame

```yaml
type: NormalExercise
key: 8c664726b8a173cda730cbb20a52ac1795d9a0e9
xp: 100
skills:
  - 1
```

Come per i vettori e le matrici, puoi selezionare gli elementi di un data frame usando le parentesi quadre `[ ]`. Utilizzando una virgola, puoi indicare cosa selezionare rispettivamente dalle righe e dalle colonne. Ad esempio:

- `my_df[1,2]` seleziona il valore della prima riga e della seconda colonna di `my_df`.
- `my_df[1:3,2:4]` seleziona le righe 1, 2, 3 e le colonne 2, 3, 4 di `my_df`.

A volte vorrai selezionare tutti gli elementi di una riga o di una colonna. Ad esempio, `my_df[1, ]` seleziona tutti gli elementi della prima riga. Applichiamo ora questa tecnica a `planets_df`!

`@instructions`
- Da `planets_df` seleziona il diametro di Mercurio: si tratta del valore nella prima riga e nella terza colonna. Quindi stampa il risultato.
- Da `planets_df` seleziona tutti i dati su Marte (la quarta riga). Quindi stampa il risultato.

`@hint`
Per selezionare il diametro di Venere (la seconda riga), avrai bisogno di `planets_df[2,3]`. Cosa ti serve quindi per selezionare il diametro Mercurio?

`@pre_exercise_code`
```{r}
# Definition of vectors
name <- c("Mercury", "Venus", "Earth", 
          "Mars", "Jupiter", "Saturn", 
          "Uranus", "Neptune")
type <- c("Terrestrial planet", 
          "Terrestrial planet", 
          "Terrestrial planet", 
          "Terrestrial planet", "Gas giant", 
          "Gas giant", "Gas giant", "Gas giant")
diameter <- c(0.382, 0.949, 1, 0.532, 
              11.209, 9.449, 4.007, 3.883)
rotation <- c(58.64, -243.02, 1, 1.03,
              0.41, 0.43, -0.72, 0.67)
rings <- c(FALSE, FALSE, FALSE, FALSE, TRUE, TRUE, TRUE, TRUE)

# Create a data frame from the vectors
planets_df <- data.frame(name, type, diameter, rotation, rings)
```

`@sample_code`
```{r}
# The planets_df data frame from the previous exercise is pre-loaded

# Print out diameter of Mercury (row 1, column 3)


# Print out data for Mars (entire fourth row)

```

`@solution`
```{r}
# The planets_df data frame from the previous exercise is pre-loaded

# Print out diameter of Mercury (row 1, column 3)
planets_df[1,3]

# Print out data for Mars (entire fourth row)
planets_df[4, ]
```

`@sct`
```{r}
msg = "Non rimuovere o sovrascrivere il data frame `planets_df`!"
ex() %>% check_object("planets_df", undefined_msg = msg) %>% check_equal(incorrect_msg = msg)

ex() %>% check_output_expr("planets_df[1,3]", missing_msg = "Hai selezionato e stampato correttamente il diametro di Mercurio? Puoi usare `[1,3]`.")

ex() %>% check_output_expr("planets_df[4, ]", missing_msg = "Hai selezionato e stampato correttamente tutti i dati per Marte? Puoi usare `[4,]`.")

success_msg("Ottimo! Oltre a selezionare elementi dal tuo data frame per indice, puoi anche usare i nomi delle colonne. Per imparare come, vai al prossimo esercizio.")
```

---

## Selezionare gli elementi di un data frame (2)

```yaml
type: NormalExercise
key: faf104fb0c605fd89f048648a4a588200bc89c76
xp: 100
skills:
  - 1
```

Invece di usare i numeri per selezionare elementi di un data frame, puoi anche utilizzare i nomi delle variabili per selezionarne le colonne. 

Supponiamo di voler selezionare i primi tre elementi della colonna `type`. Un modo per farlo è:

```
planets_df[1:3,2]
```

Un possibile svantaggio di questo approccio è che dovrai conoscere (o cercare) il numero della colonna di `type`. Un passaggio che può risultare complicato se hai molte variabili. Spesso è più semplice utilizzare il nome della variabile:

```
planets_df[1:3,"type"]
```

`@instructions`
Seleziona e stampa i primi 5 valori della colonna `"diameter"` di `planets_df`.

`@hint`
Puoi selezionare i primi cinque valori con `planets_df[1:5, ...]`. Sai come completare la parte `...` per selezionare solo la colonna `"diameter"`?

`@pre_exercise_code`
```{r}
# Definition of vectors
name <- c("Mercury", "Venus", "Earth", 
          "Mars", "Jupiter", "Saturn", 
          "Uranus", "Neptune")
type <- c("Terrestrial planet", 
          "Terrestrial planet", 
          "Terrestrial planet", 
          "Terrestrial planet", "Gas giant", 
          "Gas giant", "Gas giant", "Gas giant")
diameter <- c(0.382, 0.949, 1, 0.532, 
              11.209, 9.449, 4.007, 3.883)
rotation <- c(58.64, -243.02, 1, 1.03,
              0.41, 0.43, -0.72, 0.67)
rings <- c(FALSE, FALSE, FALSE, FALSE, TRUE, TRUE, TRUE, TRUE)

# Create a data frame from the vectors
planets_df <- data.frame(name, type, diameter, rotation, rings)
```

`@sample_code`
```{r}
# The planets_df data frame from the previous exercise is pre-loaded

# Select first 5 values of diameter column

```

`@solution`
```{r}
# The planets_df data frame from the previous exercise is pre-loaded

# Select first 5 values of diameter column
planets_df[1:5, "diameter"]
```

`@sct`
```{r}
msg = "Non rimuovere o sovrascrivere il data frame `planets_df`!"
ex() %>% check_object("planets_df", undefined_msg = msg) %>% check_equal(incorrect_msg = msg)

ex() %>% check_output_expr("planets_df[1:5, \"diameter\"]", missing_msg = "Hai selezionato correttamente i primi cinque valori dalla colonna diameter e li hai stampati? Puoi usare `[1:5, \"diameter\"]` qui.")

success_msg("Ben fatto! Continua con l'esercizio successivo!")
```

---

## Solo i pianeti con anelli

```yaml
type: NormalExercise
key: e550ecb6ec45b856e6160ddfbb3d7875998e8365
xp: 100
skills:
  - 1
```

Capiterà spesso di voler selezionare un’intera colonna, ovvero una singola variabile all’interno di un data frame. Ad esempio, se vuoi selezionare tutti gli elementi della variabile `diameter`, entrambe le opzioni faranno al caso tuo:

```
planets_df[,3]
planets_df[,"diameter"]
```

Tuttavia, esiste una scorciatoia. Se le colonne hanno un nome, puoi utilizzare il segno `$`:

```
planets_df$diameter
```

`@instructions`
- Usa il segno `$` per selezionare la variabile `rings` da `planets_df`. Salva il vettore risultante come `rings_vector`.
- Stampa `rings_vector` per vedere se hai capito bene.

`@hint`
`planets_df$diameter` seleziona la colonna `diameter` da `planets_df`; di cosa hai bisogno per selezionare la colonna `rings`?

`@pre_exercise_code`
```{r}
# Definition of vectors
name <- c("Mercury", "Venus", "Earth", 
          "Mars", "Jupiter", "Saturn", 
          "Uranus", "Neptune")
type <- c("Terrestrial planet", 
          "Terrestrial planet", 
          "Terrestrial planet", 
          "Terrestrial planet", "Gas giant", 
          "Gas giant", "Gas giant", "Gas giant")
diameter <- c(0.382, 0.949, 1, 0.532, 
              11.209, 9.449, 4.007, 3.883)
rotation <- c(58.64, -243.02, 1, 1.03,
              0.41, 0.43, -0.72, 0.67)
rings <- c(FALSE, FALSE, FALSE, FALSE, TRUE, TRUE, TRUE, TRUE)

# Create a data frame from the vectors
planets_df <- data.frame(name, type, diameter, rotation, rings)
```

`@sample_code`
```{r}
# planets_df is pre-loaded in your workspace

# Select the rings variable from planets_df
rings_vector <- 
  
# Print out rings_vector
```

`@solution`
```{r}
# planets_df is pre-loaded in your workspace

# Select the rings variable from planets_df
rings_vector <- planets_df$rings

# Print out rings_vector
rings_vector
```

`@sct`
```{r}
msg = "Non rimuovere o sovrascrivere il data frame `planets_df`!"
ex() %>% check_object("planets_df", undefined_msg = msg) %>% check_equal(incorrect_msg = msg)

ex() %>% check_object("rings_vector") %>% check_equal(incorrect_msg = "Hai selezionato correttamente la variabile `rings` da `planets_df`? Usa `$rings`. Memorizza il risultato come `rings_vector`.")

ex() %>% check_output_expr("rings_vector", missing_msg = "Non dimenticare di stampare `rings_vector` dopo averlo creato!")

success_msg("Ottimo! Continua con l'esercizio successivo e scopri un altro modo di fare il sottoinsieme!")
```

---

## Solo pianeti con anelli (2)

```yaml
type: NormalExercise
key: 1581bf4667477f274188f4f637ec7fdc73659651
xp: 100
skills:
  - 1
```

Probabilmente ti ricorderai dalle scuole superiori che alcuni pianeti del nostro sistema solare hanno degli anelli e altri no. Purtroppo non riesci a ricordare i loro nomi. R può aiutarti!

Se digiti `rings_vector` nella console, otterrai:

```
[1] FALSE FALSE FALSE FALSE  TRUE  TRUE  TRUE  TRUE
```

Ciò significa che le prime quattro osservazioni (o pianeti) non hanno un anello (`FALSE`), ma le altre quattro sì (`TRUE`). Tuttavia, in questo modo non ottieni una panoramica completa dei nomi di questi pianeti, del loro diametro, ecc. Proviamo a utilizzare `rings_vector` per selezionare i dati dei quattro pianeti con anelli.

`@instructions`
Il codice nell'editor seleziona la colonna `name` di tutti i pianeti che hanno anelli. Adatta il codice in modo che, invece della sola colonna `name`, vengano selezionate _tutte_ le colonne dei pianeti che hanno anelli.

`@hint`
Ricorda che per selezionare _tutte_ le colonne, devi semplicemente lasciare vuota la parte delle colonne tra parentesi quadre `[ ]`! Ciò significa che avrai bisogno di `[rings_vector, ]`.

`@pre_exercise_code`
```{r}
# Definition of vectors
name <- c("Mercury", "Venus", "Earth", 
          "Mars", "Jupiter", "Saturn", 
          "Uranus", "Neptune")
type <- c("Terrestrial planet", 
          "Terrestrial planet", 
          "Terrestrial planet", 
          "Terrestrial planet", "Gas giant", 
          "Gas giant", "Gas giant", "Gas giant")
diameter <- c(0.382, 0.949, 1, 0.532, 
              11.209, 9.449, 4.007, 3.883)
rotation <- c(58.64, -243.02, 1, 1.03,
              0.41, 0.43, -0.72, 0.67)
rings <- c(FALSE, FALSE, FALSE, FALSE, TRUE, TRUE, TRUE, TRUE)

# Create a data frame from the vectors
planets_df <- data.frame(name, type, diameter, rotation, rings)

rings_vector <- planets_df$rings
```

`@sample_code`
```{r}
# planets_df and rings_vector are pre-loaded in your workspace

# Adapt the code to select all columns for planets with rings
planets_df[rings_vector, "name"]
```

`@solution`
```{r}
# planets_df and rings_vector are pre-loaded in your workspace

# Adapt the code to select all columns for planets with rings
planets_df[rings_vector, ]
```

`@sct`
```{r}
msg <- "Non rimuovere o sovrascrivere `planets_df` o `rings_vector`!"
ex() %>% check_object("planets_df", undefined_msg = msg) %>% check_equal(incorrect_msg = msg)

ex() %>% check_object("rings_vector", undefined_msg = msg) %>% check_equal(incorrect_msg = msg)

ex() %>% check_output_expr('planets_df[rings_vector, ]', missing_msg = "Hai adattato correttamente il codice per selezionare _tutte_ le colonne per i pianeti che hanno anelli? Puoi usare `planets_df[rings_vector, ]`. Assicurati di includere la virgola qui, è cruciale!")

success_msg("Meraviglioso! Questa è una soluzione piuttosto noiosa. Il prossimo esercizio ti insegnerà come farlo in modo più conciso.")
```

---

## Solo i pianeti con anelli... ma con scorciatoia

```yaml
type: NormalExercise
key: a4a8b72a74097196eb2f8a28b056987aae834565
xp: 100
skills:
  - 1
```

Cosa hai imparato esattamente negli esercizi precedenti? Hai selezionato un sottoinsieme da un data frame (`planets_df`) in base al fatto che una certa condizione fosse vera o meno (anelli o non anelli) e sei riuscito a estrarre tutti i dati rilevanti. Fantastico! A questo punto, probabilmente la NASA sta già flirtando con il tuo CV ;-). 

Ora saliamo di livello e utilizziamo la funzione `subset()`. La funzione `subset()` dovrebbe essere una scorciatoia per ripetere esattamente quello che hai già fatto negli esercizi precedenti: 

```
subset(my_df, subset = some_condition)
``` 

Il primo argomento di `subset()` specifica il set di dati di cui si vuole ottenere un sottoinsieme. Aggiungendo il secondo argomento, fornisci a R le informazioni e le condizioni necessarie per selezionare il sottoinsieme corretto. 

Il codice qui sotto darà lo stesso identico risultato ottenuto nell'esercizio precedente, ma questa volta non sarà necessario usare `rings_vector`!

```
subset(planets_df, subset = rings)
```

`@instructions`
Usa `subset()` su `planets_df` per selezionare i pianeti che hanno un diametro inferiore alla Terra. Poiché la variabile `diameter` è una misura relativa del diametro del pianeta rispetto a quello della Terra, la tua condizione è `diameter < 1`.

`@hint`
`subset(planets_df, subset = ...)` risolve quasi tutto l’esercizio; riesci a completare `...`?

`@pre_exercise_code`
```{r}
# Definition of vectors
name <- c("Mercury", "Venus", "Earth", 
          "Mars", "Jupiter", "Saturn", 
          "Uranus", "Neptune")
type <- c("Terrestrial planet", 
          "Terrestrial planet", 
          "Terrestrial planet", 
          "Terrestrial planet", "Gas giant", 
          "Gas giant", "Gas giant", "Gas giant")
diameter <- c(0.382, 0.949, 1, 0.532, 
              11.209, 9.449, 4.007, 3.883)
rotation <- c(58.64, -243.02, 1, 1.03,
              0.41, 0.43, -0.72, 0.67)
rings <- c(FALSE, FALSE, FALSE, FALSE, TRUE, TRUE, TRUE, TRUE)

# Create a data frame from the vectors
planets_df <- data.frame(name, type, diameter, rotation, rings)
```

`@sample_code`
```{r}
# planets_df is pre-loaded in your workspace

# Select planets with diameter < 1

```

`@solution`
```{r}
# planets_df is pre-loaded in your workspace

# Select planets with diameter < 1
subset(planets_df, subset = diameter < 1)
```

`@sct`
```{r}
msg = "Non rimuovere o sovrascrivere il data frame `planets_df`!"
ex() %>% check_object("planets_df", undefined_msg = msg) %>% check_equal(incorrect_msg = msg)

ex()  %>% check_correct({
  ex() %>% check_output_expr("subset(planets_df, subset = diameter < 1)", missing_msg = "Hai specificato correttamente la parte `subset = ...` all'interno di `subset()`. La condizione in questo caso è `diameter < 1`. Stampa semplicemente il risultato.")  

}, {
  ex() %>% check_function("subset") %>% check_arg('x') %>% check_equal(incorrect_msg = "Il primo argomento che passi a `subset()` dovrebbe essere `planets_df`.")

})
success_msg("Ottimo! Non solo la funzione `subset()` è più concisa, ma è probabilmente anche più comprensibile per le persone che leggono il tuo codice. Continua con l'esercizio successivo.");
```

---

## Mettere in ordine

```yaml
type: NormalExercise
key: 6a6fe74d3917c37380f7ac616ce084aa7814fb8a
xp: 100
skills:
  - 1
```

Realizzare e creare classifiche è una delle attività preferite dall'uomo. Queste classifiche possono essere utili (le migliori università del mondo), divertenti (le star del cinema più influenti) o inutili (il miglior sosia di 007).

Nell’analisi dei dati, puoi ordinare i tuoi dati in base a una determinata variabile del set di dati. In R, questo si fa utilizzando la funzione `order()`. 

`order()` è una funzione che ti restituisce la posizione in classifica di ogni elemento quando viene applicata a una variabile, come ad esempio un vettore.

```
a <- c(100, 10, 1000)
order(a)
[1] 2 1 3
```

Ad esempio, 10, che è il secondo elemento di `a`, è il più piccolo, quindi 2 apparirà per primo nell’output di `order(a)`. 100, che è il primo elemento di `a`, è il secondo più piccolo, quindi 1 apparirà al secondo posto nell’output `order(a)`.

Ciò significa che possiamo utilizzare l’output di `order(a)` per riorganizzare `a`:

    

```
a[order(a)]
[1]   10  100 1000
```

`@instructions`
Sperimenta con la funzione `order()` nella console. Invia la risposta quando sei pronto a continuare.

`@hint`
Devi semplicemente usare la funzione `order()` nella console!

`@pre_exercise_code`
```{r}
# no pec
```

`@sample_code`
```{r}
# Play around with the order function in the console
```

`@solution`
```{r}
# Play around with the order function in the console
```

`@sct`
```{r}
success_msg("Ottimo! Ora usiamo la funzione `order()` per ordinare il tuo data frame!")
```

---

## Ordinare il tuo data frame

```yaml
type: NormalExercise
key: fa88b58bf2cf62e0c181dfdcbdd2e1ddeac66807
xp: 100
skills:
  - 1
```

Bene, ora che hai capito la funzione `order()`, vediamo come usarla per fare qualcosa di utile. Vorresti riorganizzare il tuo data frame in modo che inizi con il pianeta più piccolo e termini con quello più grande. Metti in ordine la colonna `diameter`.

`@instructions`
- Esegui la funzione `order()` su `planets_df$diameter` (la colonna `diameter` di `planets_df`). Memorizza il risultato come `positions`.
- Ora riorganizza `planets_df` con il vettore `positions` come indice di riga tra parentesi quadre. Mantieni tutte le colonne. Quindi stampa il risultato.

`@hint`
- Usa `order(planets_df$diameter)` per creare `positions`.
- Ora, puoi utilizzare `positions` tra parentesi quadre: `planets_df[...]`. Riesci a completare `...`?

`@pre_exercise_code`
```{r}
# Definition of vectors
name <- c("Mercury", "Venus", "Earth", 
          "Mars", "Jupiter", "Saturn", 
          "Uranus", "Neptune")
type <- c("Terrestrial planet", 
          "Terrestrial planet", 
          "Terrestrial planet", 
          "Terrestrial planet", "Gas giant", 
          "Gas giant", "Gas giant", "Gas giant")
diameter <- c(0.382, 0.949, 1, 0.532, 
              11.209, 9.449, 4.007, 3.883)
rotation <- c(58.64, -243.02, 1, 1.03,
              0.41, 0.43, -0.72, 0.67)
rings <- c(FALSE, FALSE, FALSE, FALSE, TRUE, TRUE, TRUE, TRUE)

# Create a data frame from the vectors
planets_df <- data.frame(name, type, diameter, rotation, rings)
```

`@sample_code`
```{r}
# planets_df is pre-loaded in your workspace

# Use order() to create positions
positions <-  

# Use positions to sort planets_df

```

`@solution`
```{r}
# planets_df is pre-loaded in your workspace

# Use order() to create positions
positions <- order(planets_df$diameter)

# Use positions to sort planets_df
planets_df[positions, ]
```

`@sct`
```{r}
msg = "Non rimuovere o sovrascrivere il data frame `planets_df`!"
ex() %>% check_object("planets_df", undefined_msg = msg) %>% check_equal(incorrect_msg = msg)

ex() %>% check_object("positions") %>% check_equal(incorrect_msg = "Hai calcolato correttamente la variabile `positions`? Puoi usare `order(planets_df$diameter)`.")

ex() %>% check_output_expr("planets_df[positions,]",missing_msg = "Usa `planets_df[positions, ]` per ordinare `planets_df`; la virgola all'interno delle parentesi quadre è cruciale!")

success_msg("Meraviglioso! Questo esercizio conclude il capitolo sui data frame. Ricorda che i data frame sono estremamente importanti in R, ne avrai bisogno tutto il tempo. Un'altra struttura dati molto usata è la lista. Questo sarà l'argomento del prossimo capitolo!")
```
