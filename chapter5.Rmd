---
title_meta: Capítulo 5
title: Quadros de dados
description: >-
  A maioria dos conjuntos de dados com os quais você vai trabalhar será
  armazenada como quadros de dados. Ao final deste capítulo, você será capaz de
  criar um quadro de dados, selecionar partes interessantes e ordenar um quadro
  de dados de acordo com determinadas variáveis.
---

## O que é um quadro de dados?

```yaml
type: NormalExercise
key: 7f95849020a2563168920409022ce7bed20835b5
xp: 100
skills:
  - 1
```

No capítulo sobre matrizes, você deve se lembrar de que todos os elementos que colocamos em uma matriz devem ser do mesmo tipo. Na ocasião, seu conjunto de dados sobre Star Wars continha apenas elementos numéricos. 

Ao fazer uma pesquisa de mercado, no entanto, muitas vezes temos perguntas como:

- "Você é casado?" ou perguntas do tipo "sim/não" (`logical`)
- "Quantos anos você tem?" (`numeric`)
- "Qual é a sua opinião sobre este produto?" ou outras perguntas "abertas" (`character`)
- ...

O resultado, ou seja, as respostas dos entrevistados às perguntas formuladas acima, é um conjunto de dados de diferentes tipos. Muitas vezes, você se verá trabalhando com conjuntos de dados que contêm diferentes tipos de dados, em vez de apenas um. 

Em um quadro de dados ou <i>data frame,</i> as variáveis de um conjunto de dados são armazenadas como colunas e as observações como linhas. Esse é um conceito familiar para quem já usa diferentes softwares estatísticos, como o SAS ou o SPSS.

`@instructions`
Envie a resposta. Os dados do quadro de dados de exemplo incluído, `mtcars`, serão impressos no console.

`@hint`
Envie a resposta e veja a mágica acontecer!

`@pre_exercise_code`
```{r}
# no pec
```

`@sample_code`
```{r}
# Print out built-in R data frame
mtcars 
```

`@solution`
```{r}
# Print out built-in R data frame
mtcars 
```

`@sct`
```{r}
ex() %>% check_output_expr("mtcars", missing_msg = "Não mude nada no código. Certifique-se de que você está exibindo `mtcars`.")

success_msg("Ótimo! Continue para o próximo exercício.")
```

---

## Como dar uma olhada rápida no conjunto de dados

```yaml
type: NormalExercise
key: 3d0e64ecf5f69521ee538ecc713caa02b8b0ec46
xp: 100
skills:
  - 1
```

Uau, são muitos carros! 

Trabalhar com grandes conjuntos de dados é relativamente comum na análise de dados. Ao trabalhar com conjuntos de dados e quadros de dados (extremamente) grandes, a primeira tarefa do analista de dados é adquirir uma compreensão clara de sua estrutura e dos principais elementos. Portanto, muitas vezes é útil mostrar apenas uma pequena parte de todo o conjunto de dados. 

Como fazer isso no R? Bem, a função `head()` permite mostrar as primeiras observações de um quadro de dados. Da mesma forma, a função `tail()` imprime as últimas observações do conjunto de dados.

Tanto `head()` quanto `tail()` imprimem uma linha superior chamada de cabeçalho <i>(header),</i> que contém o nome das diferentes variáveis do conjunto de dados.

`@instructions`
Chame `head()` no conjunto de dados `mtcars` para dar uma olhada no cabeçalho e nas primeiras observações.

`@hint`
`head(mtcars)` mostra as primeiras observações do quadro de dados `mtcars`.

`@pre_exercise_code`
```{r}
# no pec
```

`@sample_code`
```{r}
# Call head() on mtcars

```

`@solution`
```{r}
# Call head() on mtcars
head(mtcars)
```

`@sct`
```{r}
ex() %>% check_function("head") %>% check_arg('x') %>% check_equal(incorrect_msg = "Você passou corretamente `mtcars` para a função `head()`?")

ex() %>% check_output_expr("head(mtcars)", missing_msg = "Simplesmente imprima o resultado da chamada `head()`, não precisa atribuí-lo a uma nova variável.")

success_msg("Maravilha! Então, o que temos neste conjunto de dados? Por exemplo, `hp` representa a potência do carro; o Datsun tem a menor potência dos 6 carros que são exibidos. Para uma visão completa do significado das variáveis, digite `?mtcars` no console e leia a página de ajuda. Continue para o próximo exercício!");
```

---

## Dê uma olhada na estrutura

```yaml
type: NormalExercise
key: f4d5b1a2c4aef31645fc7e3505e699fb6e48f3e6
xp: 100
skills:
  - 1
```

Outro método usado com frequência para ter uma visão geral rápida dos dados é a função `str()`. A função `str()` mostra a estrutura do conjunto de dados. Para um quadro de dados, ele informa:

- O número total de observações (ex.: 32 tipos de carros)
- O número total de variáveis (ex.: 11 características dos carros)
- Uma lista completa dos nomes das variáveis (ex.: `mpg`, `cyl`... )
- O tipo de dados de cada variável (ex.: `num`)
- As primeiras observações

A aplicação da função `str()` geralmente é a primeira coisa que fazemos ao receber um novo conjunto de dados ou quadro de dados. É uma ótima maneira de entender melhor o conjunto de dados antes de ir a fundo nas análises.

`@instructions`
Investigue a estrutura de `mtcars`. Confira se está vendo os mesmos números, variáveis e tipos de dados mencionados acima.

`@hint`
Use a função `str()` com `mtcars`.

`@pre_exercise_code`
```{r}
# no pec
```

`@sample_code`
```{r}
# Investigate the structure of mtcars

```

`@solution`
```{r}
# Investigate the structure of mtcars
str(mtcars)
```

`@sct`
```{r}
ex() %>% check_output_expr("str(mtcars)", missing_msg = "Você chamou corretamente `str()` em `mtcars`?")

success_msg("Bom trabalho! Você pode encontrar muitas informações visualizando o `str()` de um conjunto de dados. Continue para o próximo exercício.")
```

---

## Criação de um quadro de dados

```yaml
type: NormalExercise
key: df0b89706d90526b3c0bbe15e400b74cbd900704
xp: 100
skills:
  - 1
```

Usar conjuntos de dados já incluídos não é tão divertido quanto criar os próprios conjuntos de dados. Portanto, o restante deste capítulo se baseia em um conjunto de dados desenvolvido pessoalmente. Coloque sua mochila a jato porque é hora de explorar o espaço! 

Seu primeiro objetivo é construir um quadro de dados que descreva as principais características de oito planetas do nosso sistema solar. De acordo com nosso bom amigo Buzz, as principais características de um planeta são:

- O tipo de planeta (terrestre ou gigante gasoso).
- O diâmetro do planeta em relação ao diâmetro da Terra.
- A rotação do planeta ao redor do sol em relação à da Terra.
- Se o planeta tem anéis ou não (TRUE ou FALSE).

Depois de fazer uma pesquisa de alta qualidade na [Wikipedia](https://en.wikipedia.org/wiki/Planet), você se sente confiante o suficiente para criar os vetores necessários: `name`, `type`, `diameter`, `rotation` e `rings`. Esses vetores já foram codificados no editor. O primeiro elemento de cada um desses vetores corresponde à primeira observação.

Para construir um quadro de dados, usamos a função `data.frame()`. Como argumentos, passamos os vetores de antes: eles se tornarão as diferentes colunas do quadro de dados. Como cada coluna tem o mesmo tamanho, os vetores que passamos também devem ter o mesmo tamanho. Mas não se esqueça de que é possível (e provável) que contenham diferentes tipos de dados.

`@instructions`
Use a função `data.frame()` para construir um quadro de dados. Passe os vetores `name`, `type`, `diameter`, `rotation` e `rings` como argumentos em `data.frame()`, nessa ordem. Chame `planets_df`, o quadro de dados resultante.

`@hint`
A chamada de `data.frame()` começa assim:
```
data.frame(planets, type, diameter)
```
Você consegue terminar?

`@pre_exercise_code`
```{r}
# no pec
```

`@sample_code`
```{r}
# Definition of vectors
name <- c("Mercury", "Venus", "Earth", 
          "Mars", "Jupiter", "Saturn", 
          "Uranus", "Neptune")
type <- c("Terrestrial planet", 
          "Terrestrial planet", 
          "Terrestrial planet", 
          "Terrestrial planet", "Gas giant", 
          "Gas giant", "Gas giant", "Gas giant")
diameter <- c(0.382, 0.949, 1, 0.532, 
              11.209, 9.449, 4.007, 3.883)
rotation <- c(58.64, -243.02, 1, 1.03, 
              0.41, 0.43, -0.72, 0.67)
rings <- c(FALSE, FALSE, FALSE, FALSE, TRUE, TRUE, TRUE, TRUE)

# Create a data frame from the vectors
planets_df <-

```

`@solution`
```{r}
# Definition of vectors
name <- c("Mercury", "Venus", "Earth", 
          "Mars", "Jupiter", "Saturn", 
          "Uranus", "Neptune")
type <- c("Terrestrial planet", 
          "Terrestrial planet", 
          "Terrestrial planet", 
          "Terrestrial planet", "Gas giant", 
          "Gas giant", "Gas giant", "Gas giant")
diameter <- c(0.382, 0.949, 1, 0.532, 
              11.209, 9.449, 4.007, 3.883)
rotation <- c(58.64, -243.02, 1, 1.03,
              0.41, 0.43, -0.72, 0.67)
rings <- c(FALSE, FALSE, FALSE, FALSE, TRUE, TRUE, TRUE, TRUE)

# Create a data frame from the vectors
planets_df <- data.frame(name, type, diameter, rotation, rings)
```

`@sct`
```{r}
msg = "Não mude nada na definição dos vetores. Apenas adicione uma chamada `data.frame()` para criar `planets_df`."
ex() %>% check_object("name", undefined_msg = msg) %>% check_equal(incorrect_msg = msg)

ex() %>% check_object("type", undefined_msg = msg) %>% check_equal(incorrect_msg = msg)

ex() %>% check_object("diameter", undefined_msg = msg) %>% check_equal(incorrect_msg = msg)

ex() %>% check_object("rotation", undefined_msg = msg) %>% check_equal(incorrect_msg = msg)

ex() %>% check_object("rings", undefined_msg = msg) %>% check_equal(incorrect_msg = msg)

ex() %>% check_object("planets_df") %>% check_equal(incorrect_msg = "Você chamou corretamente `data.frame()` para criar `planets_df`? Dentro de `data.frame()`, certifique-se de passar todos os vetores na ordem correta: `name`, `type`, `diameter`, `rotation` e finalmente `rings`.")

success_msg("Mandou bem! O próximo passo lógico, como você já sabe, é inspecionar o data frame que você acabou de criar. Vá para o próximo exercício.")
```

---

## Criação de um quadro de dados (2)

```yaml
type: NormalExercise
key: c13ea421dd078030a225f49e53a8927ce8fefbe0
xp: 100
skills:
  - 1
```

O quadro de dados `planets_df` deve ter 8 observações e 5 variáveis. Ele já foi disponibilizado no espaço de trabalho, para que você possa usá-lo diretamente.

`@instructions`
Use `str()` para investigar a estrutura da nova variável `planets_df`.

`@hint`
`planets_df` já está disponível no espaço de trabalho, portanto `str(planets_df)` é suficiente.

`@pre_exercise_code`
```{r}
# Definition of vectors
name <- c("Mercury", "Venus", "Earth", 
          "Mars", "Jupiter", "Saturn", 
          "Uranus", "Neptune")
type <- c("Terrestrial planet", 
          "Terrestrial planet", 
          "Terrestrial planet", 
          "Terrestrial planet", "Gas giant", 
          "Gas giant", "Gas giant", "Gas giant")
diameter <- c(0.382, 0.949, 1, 0.532, 
              11.209, 9.449, 4.007, 3.883)
rotation <- c(58.64, -243.02, 1, 1.03,
              0.41, 0.43, -0.72, 0.67)
rings <- c(FALSE, FALSE, FALSE, FALSE, TRUE, TRUE, TRUE, TRUE)

# Create a data frame from the vectors
planets_df <- data.frame(name, type, diameter, rotation, rings)
```

`@sample_code`
```{r}
# Check the structure of planets_df
```

`@solution`
```{r}
# Check the structure of planets_df
str(planets_df)
```

`@sct`
```{r}
msg = "Não remova ou sobrescreva o data frame `planets_df` que já está disponível no espaço de trabalho!"
ex() %>% check_object("planets_df", undefined_msg = msg) %>% check_equal(incorrect_msg = msg)

ex() %>% check_output_expr("str(planets_df)", missing_msg = "Você exibiu corretamente a estrutura do `planets_df`? Use `str()` para fazer isso!")

success_msg("Incrível! Agora que você tem uma compreensão clara do dataset `planets_df`, é hora de ver como você pode selecionar elementos dele. Aprenda tudo sobre isso nos próximos exercícios!")
```

---

## Seleção de elementos de quadros de dados

```yaml
type: NormalExercise
key: 8c664726b8a173cda730cbb20a52ac1795d9a0e9
xp: 100
skills:
  - 1
```

Assim como em vetores e matrizes, é possível selecionar elementos de um quadro de dados com a ajuda de colchetes `[ ]`. Usando uma vírgula, podemos indicar o que deve ser selecionado nas linhas e nas colunas, respectivamente. Por exemplo:

- `my_df[1,2]` seleciona o valor da primeira linha e da segunda coluna em `my_df`.
- `my_df[1:3,2:4]` seleciona as linhas 1, 2 e 3 e as colunas 2, 3 e 4 em `my_df`.

Às vezes, desejamos selecionar todos os elementos de uma linha ou coluna. Por exemplo: `my_df[1, ]` seleciona todos os elementos da primeira linha. Agora vamos aplicar essa técnica com `planets_df`!

`@instructions`
- Em `planets_df`, selecione o diâmetro de Mercúrio: é o valor da primeira linha e da terceira coluna. Imprima o resultado de novo.
- Em `planets_df`, selecione todos os dados sobre Marte (a quarta linha). Imprima o resultado de novo.

`@hint`
Para selecionar o diâmetro de Vênus (a segunda linha), você precisaria usar: `planets_df[2,3]`. Então, o que você precisa usar para Mercúrio?

`@pre_exercise_code`
```{r}
# Definition of vectors
name <- c("Mercury", "Venus", "Earth", 
          "Mars", "Jupiter", "Saturn", 
          "Uranus", "Neptune")
type <- c("Terrestrial planet", 
          "Terrestrial planet", 
          "Terrestrial planet", 
          "Terrestrial planet", "Gas giant", 
          "Gas giant", "Gas giant", "Gas giant")
diameter <- c(0.382, 0.949, 1, 0.532, 
              11.209, 9.449, 4.007, 3.883)
rotation <- c(58.64, -243.02, 1, 1.03,
              0.41, 0.43, -0.72, 0.67)
rings <- c(FALSE, FALSE, FALSE, FALSE, TRUE, TRUE, TRUE, TRUE)

# Create a data frame from the vectors
planets_df <- data.frame(name, type, diameter, rotation, rings)
```

`@sample_code`
```{r}
# The planets_df data frame from the previous exercise is pre-loaded

# Print out diameter of Mercury (row 1, column 3)


# Print out data for Mars (entire fourth row)

```

`@solution`
```{r}
# The planets_df data frame from the previous exercise is pre-loaded

# Print out diameter of Mercury (row 1, column 3)
planets_df[1,3]

# Print out data for Mars (entire fourth row)
planets_df[4, ]
```

`@sct`
```{r}
msg = "Não remova ou sobrescreva o data frame `planets_df`!"
ex() %>% check_object("planets_df", undefined_msg = msg) %>% check_equal(incorrect_msg = msg)

ex() %>% check_output_expr("planets_df[1,3]", missing_msg = "Você selecionou e imprimiu corretamente o diâmetro de Mercúrio? Você pode usar `[1,3]`.")

ex() %>% check_output_expr("planets_df[4, ]", missing_msg = "Você selecionou e imprimiu corretamente todos os dados de Marte? Você pode usar `[4,]`.")

success_msg("Ótimo! Além de selecionar elementos do seu data frame por índice, você também pode usar os nomes das colunas. Para aprender como, vá para o próximo exercício.")
```

---

## Seleção de elementos de quadros de dados (2)

```yaml
type: NormalExercise
key: faf104fb0c605fd89f048648a4a588200bc89c76
xp: 100
skills:
  - 1
```

Em vez de usar números para selecionar elementos de um quadro de dados, também podemos usar o nome das variáveis para selecionar colunas de um quadro de dados. 

Suponha que seja necessário selecionar os três primeiros elementos da coluna `type`. Uma maneira de fazer isso é

```
planets_df[1:3,2]
```

Uma possível desvantagem dessa abordagem é que precisamos saber (ou procurar) o número da coluna de `type`, o que fica difícil quando temos muitas variáveis. Muitas vezes, é mais fácil usar apenas o nome da variável:

```
planets_df[1:3,"type"]
```

`@instructions`
Selecione e imprima os cinco primeiros valores da coluna `"diameter"` de `planets_df`.

`@hint`
Você pode selecionar os cinco primeiros valores com `planets_df[1:5, ...]`. Você consegue preencher o espaço `...` para selecionar somente a coluna `"diameter"`?

`@pre_exercise_code`
```{r}
# Definition of vectors
name <- c("Mercury", "Venus", "Earth", 
          "Mars", "Jupiter", "Saturn", 
          "Uranus", "Neptune")
type <- c("Terrestrial planet", 
          "Terrestrial planet", 
          "Terrestrial planet", 
          "Terrestrial planet", "Gas giant", 
          "Gas giant", "Gas giant", "Gas giant")
diameter <- c(0.382, 0.949, 1, 0.532, 
              11.209, 9.449, 4.007, 3.883)
rotation <- c(58.64, -243.02, 1, 1.03,
              0.41, 0.43, -0.72, 0.67)
rings <- c(FALSE, FALSE, FALSE, FALSE, TRUE, TRUE, TRUE, TRUE)

# Create a data frame from the vectors
planets_df <- data.frame(name, type, diameter, rotation, rings)
```

`@sample_code`
```{r}
# The planets_df data frame from the previous exercise is pre-loaded

# Select first 5 values of diameter column

```

`@solution`
```{r}
# The planets_df data frame from the previous exercise is pre-loaded

# Select first 5 values of diameter column
planets_df[1:5, "diameter"]
```

`@sct`
```{r}
msg = "Não remova ou sobrescreva o data frame `planets_df`!"
ex() %>% check_object("planets_df", undefined_msg = msg) %>% check_equal(incorrect_msg = msg)

ex() %>% check_output_expr("planets_df[1:5, \"diameter\"]", missing_msg = "Você selecionou corretamente os primeiros cinco valores da coluna de diâmetro e os imprimiu? Você pode usar `[1:5, \"diameter\"]` aqui.")

success_msg("Legal! Continue para o próximo exercício!")
```

---

## Somente planetas com anéis

```yaml
type: NormalExercise
key: e550ecb6ec45b856e6160ddfbb3d7875998e8365
xp: 100
skills:
  - 1
```

Muitas vezes, é necessário selecionar uma coluna inteira, ou seja, uma variável específica de um quadro de dados. Para selecionar todos os elementos da variável `diameter`, por exemplo, ambas as opções são suficientes:

```
planets_df[,3]
planets_df[,"diameter"]
```

No entanto, há um atalho. Se as colunas tiverem nomes, podemos usar o sinal `$`:

```
planets_df$diameter
```

`@instructions`
- Use o sinal `$` para selecionar a variável `rings` de `planets_df`. Armazene o vetor resultante como `rings_vector`.
- Imprima `rings_vector` para ver se deu certo.

`@hint`
`planets_df$diameter` seleciona a coluna `diameter` de `planets_df`. Assim, do que você precisa para selecionar a coluna `rings`?

`@pre_exercise_code`
```{r}
# Definition of vectors
name <- c("Mercury", "Venus", "Earth", 
          "Mars", "Jupiter", "Saturn", 
          "Uranus", "Neptune")
type <- c("Terrestrial planet", 
          "Terrestrial planet", 
          "Terrestrial planet", 
          "Terrestrial planet", "Gas giant", 
          "Gas giant", "Gas giant", "Gas giant")
diameter <- c(0.382, 0.949, 1, 0.532, 
              11.209, 9.449, 4.007, 3.883)
rotation <- c(58.64, -243.02, 1, 1.03,
              0.41, 0.43, -0.72, 0.67)
rings <- c(FALSE, FALSE, FALSE, FALSE, TRUE, TRUE, TRUE, TRUE)

# Create a data frame from the vectors
planets_df <- data.frame(name, type, diameter, rotation, rings)
```

`@sample_code`
```{r}
# planets_df is pre-loaded in your workspace

# Select the rings variable from planets_df
rings_vector <- 
  
# Print out rings_vector
```

`@solution`
```{r}
# planets_df is pre-loaded in your workspace

# Select the rings variable from planets_df
rings_vector <- planets_df$rings

# Print out rings_vector
rings_vector
```

`@sct`
```{r}
msg = "Não remova ou sobrescreva o data frame `planets_df`!"
ex() %>% check_object("planets_df", undefined_msg = msg) %>% check_equal(incorrect_msg = msg)

ex() %>% check_object("rings_vector") %>% check_equal(incorrect_msg = "Você selecionou corretamente a variável `rings` de `planets_df`? Use `$rings`. Armazene o resultado como `rings_vector`.")

ex() %>% check_output_expr("rings_vector", missing_msg = "Não se esqueça de imprimir `rings_vector` depois de criá-lo!")

success_msg("Ótimo! Continue para o próximo exercício e descubra mais uma maneira de fazer subsetting!")
```

---

## Somente planetas com anéis (2)

```yaml
type: NormalExercise
key: 1581bf4667477f274188f4f637ec7fdc73659651
xp: 100
skills:
  - 1
```

Você deve se lembrar da época do ensino médio que alguns planetas do sistema solar têm anéis, e outros não. Infelizmente, você não se lembra de quais. Será que o R pode ajudar?

Se você digitar `rings_vector` no console, verá o seguinte:

```
[1] FALSE FALSE FALSE FALSE  TRUE  TRUE  TRUE  TRUE
```

Isso significa que as primeiras quatro observações (ou planetas) não têm anel (`FALSE`), mas as outras quatro têm (`TRUE`). No entanto, você não tem uma boa visão geral do nome desses planetas, do diâmetro, etc. Vamos tentar usar `rings_vector` para selecionar os dados dos quatro planetas com anéis.

`@instructions`
O código no editor seleciona a coluna `name` de todos os planetas que têm anéis. Adapte o código de modo que, em vez de selecionar apenas a coluna `name`, _todas_ as colunas dos planetas que têm anéis sejam selecionadas.

`@hint`
Lembre-se de que, para selecionar _todas_ as colunas, basta deixar a parte das colunas dentro de `[ ]` vazia! Isso significa que você precisa usar `[rings_vector, ]`.

`@pre_exercise_code`
```{r}
# Definition of vectors
name <- c("Mercury", "Venus", "Earth", 
          "Mars", "Jupiter", "Saturn", 
          "Uranus", "Neptune")
type <- c("Terrestrial planet", 
          "Terrestrial planet", 
          "Terrestrial planet", 
          "Terrestrial planet", "Gas giant", 
          "Gas giant", "Gas giant", "Gas giant")
diameter <- c(0.382, 0.949, 1, 0.532, 
              11.209, 9.449, 4.007, 3.883)
rotation <- c(58.64, -243.02, 1, 1.03,
              0.41, 0.43, -0.72, 0.67)
rings <- c(FALSE, FALSE, FALSE, FALSE, TRUE, TRUE, TRUE, TRUE)

# Create a data frame from the vectors
planets_df <- data.frame(name, type, diameter, rotation, rings)

rings_vector <- planets_df$rings
```

`@sample_code`
```{r}
# planets_df and rings_vector are pre-loaded in your workspace

# Adapt the code to select all columns for planets with rings
planets_df[rings_vector, "name"]
```

`@solution`
```{r}
# planets_df and rings_vector are pre-loaded in your workspace

# Adapt the code to select all columns for planets with rings
planets_df[rings_vector, ]
```

`@sct`
```{r}
msg <- "Não remova ou sobrescreva `planets_df` ou `rings_vector`!"
ex() %>% check_object("planets_df", undefined_msg = msg) %>% check_equal(incorrect_msg = msg)

ex() %>% check_object("rings_vector", undefined_msg = msg) %>% check_equal(incorrect_msg = msg)

ex() %>% check_output_expr('planets_df[rings_vector, ]', missing_msg = "Você adaptou corretamente o código para selecionar _todas_ as colunas para os planetas que têm anéis? Você pode usar `planets_df[rings_vector, ]`. Certifique-se de incluir a vírgula aqui, é crucial!")

success_msg("Maravilha! Esta é uma solução bastante tediosa. O próximo exercício vai te ensinar como fazer isso de uma maneira mais concisa.")
```

---

## Somente planetas com anéis, mas mais compacto

```yaml
type: NormalExercise
key: a4a8b72a74097196eb2f8a28b056987aae834565
xp: 100
skills:
  - 1
```

O que você aprendeu exatamente nos exercícios anteriores? Você selecionou um subconjunto de um quadro de dados (`planets_df`) com base no fato de uma determinada condição ser verdadeira ou não (com ou sem anéis) e conseguiu extrair todos os dados relevantes. Muito legal! A essa altura, a NASA já deve estar de olho no seu currículo ;-). 

Agora, vamos subir um nível e usar a função `subset()`. A função `subset()` pode ser vista como um atalho para fazer exatamente o mesmo que você fez nos exercícios anteriores. 

```
subset(my_df, subset = some_condition)
``` 

O primeiro argumento de `subset()` especifica o conjunto de dados do qual você deseja um subconjunto. Ao adicionar o segundo argumento, você fornece ao R as informações e condições necessárias para selecionar o subconjunto correto. 

O código abaixo gera exatamente o mesmo resultado obtido no exercício anterior, mas, desta vez, você não precisou do `rings_vector`!

```
subset(planets_df, subset = rings)
```

`@instructions`
Use `subset()` com `planets_df` para selecionar planetas que tenham diâmetro menor que o da Terra. Como a variável `diameter` é uma medida relativa do diâmetro do planeta em relação ao diâmetro da Terra, a condição é `diameter < 1`.

`@hint`
`subset(planets_df, subset = ...)` quase resolve o problema; você consegue preencher o espaço `...`?

`@pre_exercise_code`
```{r}
# Definition of vectors
name <- c("Mercury", "Venus", "Earth", 
          "Mars", "Jupiter", "Saturn", 
          "Uranus", "Neptune")
type <- c("Terrestrial planet", 
          "Terrestrial planet", 
          "Terrestrial planet", 
          "Terrestrial planet", "Gas giant", 
          "Gas giant", "Gas giant", "Gas giant")
diameter <- c(0.382, 0.949, 1, 0.532, 
              11.209, 9.449, 4.007, 3.883)
rotation <- c(58.64, -243.02, 1, 1.03,
              0.41, 0.43, -0.72, 0.67)
rings <- c(FALSE, FALSE, FALSE, FALSE, TRUE, TRUE, TRUE, TRUE)

# Create a data frame from the vectors
planets_df <- data.frame(name, type, diameter, rotation, rings)
```

`@sample_code`
```{r}
# planets_df is pre-loaded in your workspace

# Select planets with diameter < 1

```

`@solution`
```{r}
# planets_df is pre-loaded in your workspace

# Select planets with diameter < 1
subset(planets_df, subset = diameter < 1)
```

`@sct`
```{r}
msg = "Não remova ou sobrescreva o data frame `planets_df`!"
ex() %>% check_object("planets_df", undefined_msg = msg) %>% check_equal(incorrect_msg = msg)

ex()  %>% check_correct({
  ex() %>% check_output_expr("subset(planets_df, subset = diameter < 1)", missing_msg = "Você especificou corretamente a parte `subset = ...` dentro de `subset()`? A condição neste caso é `diameter < 1`. Simplesmente imprima o resultado.")  

}, {
  ex() %>% check_function("subset") %>% check_arg('x') %>% check_equal(incorrect_msg = "O primeiro argumento que você passa para `subset()` deve ser `planets_df`.")

})
success_msg("Ótimo! A função `subset()` não é apenas mais concisa, mas provavelmente também é mais compreensível para as pessoas que leem seu código. Continue para o próximo exercício.");
```

---

## Classificação

```yaml
type: NormalExercise
key: 6a6fe74d3917c37380f7ac616ce084aa7814fb8a
xp: 100
skills:
  - 1
```

Fazer e criar classificações é uma das atividades favoritas da humanidade. Essas classificações podem ser úteis (melhores universidades do mundo), divertidas (estrelas de cinema mais influentes) ou sem sentido (melhor sósia do 007).

Na análise de dados, podemos classificar os dados de acordo com uma determinada variável do conjunto de dados. No R, isso é feito com a ajuda da função `order()`. 

`order()` é uma função que fornece a posição classificada de cada elemento quando é aplicada a uma variável, como um vetor, por exemplo:

```
a <- c(100, 10, 1000)
order(a)
[1] 2 1 3
```

10, que é o segundo elemento de `a`, é o menor elemento, portanto 2 vem primeiro na saída de `order(a)`. 100, que é o primeiro elemento de `a`, é o segundo menor elemento, portanto 1 vem em segundo lugar na saída de `order(a)`.

Isso significa que podemos usar a saída de `order(a)` para reorganizar `a`:

    

```
a[order(a)]
[1]   10  100 1000
```

`@instructions`
Faça experiências com a função `order()` no console. Envie a resposta quando estiver pronto para continuar.

`@hint`
É só brincar com a função `order()` no console!

`@pre_exercise_code`
```{r}
# no pec
```

`@sample_code`
```{r}
# Play around with the order function in the console
```

`@solution`
```{r}
# Play around with the order function in the console
```

`@sct`
```{r}
success_msg("Ótimo! Agora vamos usar a função `order()` para classificar seu data frame!")
```

---

## Classificação de um quadro de dados

```yaml
type: NormalExercise
key: fa88b58bf2cf62e0c181dfdcbdd2e1ddeac66807
xp: 100
skills:
  - 1
```

Muito bem, agora que você entende a função `order()`, vamos fazer algo útil com ela. Você gostaria de reorganizar seu quadro de dados de forma que ele comece pelo menor planeta e termine com o maior. Uma classificação pela coluna `diameter`.

`@instructions`
- Chame `order()` com `planets_df$diameter` (a coluna `diameter` de `planets_df`). Armazene o resultado como `positions`.
- Agora, reorganize `planets_df` com o vetor `positions` como índice de linhas entre colchetes. Mantenha todas as colunas. Imprima o resultado de novo.

`@hint`
- Use `order(planets_df$diameter)` para criar `positions`.
- Agora, você pode usar `positions` entre colchetes: `planets_df[...]`. Você consegue preencher o espaço `...`?

`@pre_exercise_code`
```{r}
# Definition of vectors
name <- c("Mercury", "Venus", "Earth", 
          "Mars", "Jupiter", "Saturn", 
          "Uranus", "Neptune")
type <- c("Terrestrial planet", 
          "Terrestrial planet", 
          "Terrestrial planet", 
          "Terrestrial planet", "Gas giant", 
          "Gas giant", "Gas giant", "Gas giant")
diameter <- c(0.382, 0.949, 1, 0.532, 
              11.209, 9.449, 4.007, 3.883)
rotation <- c(58.64, -243.02, 1, 1.03,
              0.41, 0.43, -0.72, 0.67)
rings <- c(FALSE, FALSE, FALSE, FALSE, TRUE, TRUE, TRUE, TRUE)

# Create a data frame from the vectors
planets_df <- data.frame(name, type, diameter, rotation, rings)
```

`@sample_code`
```{r}
# planets_df is pre-loaded in your workspace

# Use order() to create positions
positions <-  

# Use positions to sort planets_df

```

`@solution`
```{r}
# planets_df is pre-loaded in your workspace

# Use order() to create positions
positions <- order(planets_df$diameter)

# Use positions to sort planets_df
planets_df[positions, ]
```

`@sct`
```{r}
msg = "Não remova ou sobrescreva o data frame `planets_df`!"
ex() %>% check_object("planets_df", undefined_msg = msg) %>% check_equal(incorrect_msg = msg)

ex() %>% check_object("positions") %>% check_equal(incorrect_msg = "Você calculou corretamente a variável `positions`? Você pode usar `order(planets_df$diameter)`.")

ex() %>% check_output_expr("planets_df[positions,]",missing_msg = "Use `planets_df[positions, ]` para ordenar `planets_df`; a vírgula dentro dos colchetes é crucial!")

success_msg("Maravilha! Este exercício conclui o capítulo sobre data frames. Lembre-se de que data frames são extremamente importantes no R, você vai precisar deles o tempo todo. Outra estrutura de dados muito usada é a lista. Este será o assunto do próximo capítulo!")
```
